You already generated a decentralized web app on Solana (Anchor program + React + IPFS) for a campus suggestion system + academic notes hub. 
Now REFINE and HARDEN the existing codebase with the following SECURITY requirements. 
Make minimal changes to structure, but apply robust guardrails.

========================
SCOPE & CONTEXT
========================
- Existing features:
  - Submit on-chain suggestions (title, description, category, author, timestamp)
  - Upload notes to IPFS, store CID + metadata on-chain
  - Notes request board on-chain

- Tech stack:
  - Anchor for Solana programs
  - React + Vite + TypeScript + Tailwind
  - Solana Wallet Adapter (Phantom)
  - @solana/web3.js client
  - IPFS via Web3.Storage or Pinata

========================
TASKS — SECURITY HARDENING
========================

[1] ANCHOR PROGRAM: ACCESS CONTROL & VALIDATION
- Enforce PDAs with deterministic seeds:
  - Suggestions PDA seeds: ["suggestion", author_pubkey, ts_le_bytes]
  - Notes PDA seeds: ["note", author_pubkey, cid_bytes]
  - Requests PDA seeds: ["request", author_pubkey, subject_bytes or short hash]
- For each account init:
  - Use `#[account(init, payer = signer, seeds = [...], bump, space = ...)]`
  - Re-derive PDA in handlers and require equality (`require_keys_eq!`)
- Validate inputs:
  - `title`: 3..120 chars, ASCII/UTF‑8 safe
  - `description`: 10..1000 chars
  - `category`: u8 enum with allowed values (0=Academics, 1=Infrastructure, 2=Exams, 3=Canteen, 4=Other)
- Implement `AppError` with messages: InvalidTitle, InvalidDescription, InvalidCategory, PdaMismatch, Unauthorized, ClockUnavailable
- Emit events for create/update to support auditability: SuggestionCreated, NoteUploaded, RequestCreated
- Add tiny anti‑spam fee:
  - Treasury SystemAccount PDA with seed ["treasury"]
  - Transfer 0.00001 SOL (10_000 lamports) from signer to treasury on createSuggestion/createNoteRequest
- Ensure accounts are only `mut` when needed; do not trust client-passed accounts.

[2] ANCHOR PROGRAM: SPACE & RENT
- Compute precise `space` for each account (8 discriminator + field sizes).
- Keep large content off-chain; only store CID, short title/description, category, author, timestamps.

[3] FRONTEND: SAFE TRANSACTIONS
- Before sending any transaction:
  - Add compute budget instructions:
    - `setComputeUnitLimit({ units: 200_000 })`
    - `setComputeUnitPrice({ microLamports: 5000 })`
  - Simulate transaction (`connection.simulateTransaction`) and show human-readable errors.
- Use `confirmed/finalized` commitment for reads and write confirmations.
- Add exponential backoff and retries for `BlockhashNotFound`/`TransactionExpired`.

[4] FRONTEND: INPUT SANITIZATION & XSS DEFENSE
- Sanitize user input and output:
  - Strip dangerous HTML; do NOT use `dangerouslySetInnerHTML`.
  - Enforce client-side length checks consistent with on-chain.
- Add basic Content Security Policy (meta tag in index.html):
  - `default-src 'self'; img-src 'self' data: https:; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; connect-src 'self' https://api.mainnet-beta.solana.com https://api.devnet.solana.com *;`
- Handle wallet disconnects gracefully; do NOT autoConnect by default.

[5] OPTIONAL BACKEND: SIWS (Sign-In with Solana) STUB
- Generate a tiny Node/Express server stub (in `/server`) to verify signed messages for:
  - Rate limiting uploads/pins
  - Optional admin actions (flag content)
- Client flow:
  - Create a nonce; user signs `Sign-in for CampusHub\nNonce:{nonce}\nTS:{timestamp}`
  - Send `{address, message, signature}` to `/auth/verify`
- Server flow:
  - Verify ed25519 signature; single-use nonce memory store; return JWT (local-only, demo).

[6] IPFS HANDLING
- Use Web3.Storage or Pinata SDK:
  - Upload notes; return `CID`
  - Store only `CID`, title, subject, fileType, size in on-chain metadata
- Add optional "Private Note (beta)" toggle:
  - If enabled, encrypt file client-side (simple AES‑GCM with random key)
  - Encrypt the AES key for recipient using tweetnacl `box` (X25519)
  - Store encrypted blob on IPFS; store CID + encryptedKey + nonce on-chain
- Add a client-side blocklist support:
  - Maintain a JSON of flagged CIDs (`/app/src/blocked.json`)
  - Filter out flagged content in feeds

[7] README UPDATE (AUTO-GENERATE)
Create/replace README with:
- Overview, features, architecture diagram (ASCII)
- Security notes:
  - PDA derivation and checks
  - Input validation limits
  - Anti-spam fee
  - Transaction simulation + priority fees
  - CSP and sanitization
  - IPFS content model and optional encryption
- Setup:
  - Anchor: build, test, deploy devnet
  - Frontend: env vars, run locally, build
  - Optional server: SIWS verification run
- Submission checklist: public repo, live link, demo steps

[8] TESTS
- Add `anchor test` cases:
  - Valid create suggestion -> succeeds
  - Invalid lengths -> fails
  - PDA mismatch -> fails
  - Treasury fee transfer executed
- Frontend unit tests (lightweight) for input validators.

========================
CODE TO ADD / MODIFY — EXAMPLES
========================

[A] Rust (errors):
```rust
#[error_code]
pub enum AppError {
    #[msg("Invalid title length")] InvalidTitle,
    #[msg("Invalid description length")] InvalidDescription,
    #[msg("Invalid category value")] InvalidCategory,
    #[msg("PDA mismatch")] PdaMismatch,
    #[msg("Unauthorized")] Unauthorized,
    #[msg("Clock unavailable")] ClockUnavailable,
}